<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>瞎折腾分享</title><link>/</link><description>记录分享一些使用经验</description><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>https://cdn.jsdelivr.net/gh/fejich/fejich.github.io@gh-pages/logo.png</url><title>瞎折腾分享</title><link>/</link></image><language>zh-CN</language><lastBuildDate>Tue, 07 Sep 2021 12:00:25 +0806</lastBuildDate><pubDate>Tue, 07 Sep 2021 12:00:25 +0806</pubDate><item><title>我的第一篇文章</title><link>/archives/my-first-awesome-post/</link><description>&lt;p&gt;这是我的第一篇文章。文章使用 GitHub 管理，并通过 GitHub Actions 自动构建与发布！&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img data-width="836" data-height="450" src="https://cdn.jsdelivr.net/gh/fejich/fejich.github.io@gh-pages/archives/assets/e0affbc80ccb2d596c87b520e37e7071.jpg" alt="幽灵公主剧照" /&gt;&lt;figcaption&gt;幽灵公主剧照&lt;/figcaption&gt;&lt;/figure&gt;&lt;/p&gt;
</description><author>hi@imalan.cn (fejich)</author><guid isPermaLink="true">/archives/my-first-awesome-post/</guid><pubDate>Tue, 07 Sep 2021 14:20:00 +0806</pubDate></item><item><title>unRAID 系统下虚拟机黑群辉硬盘无损扩容记录</title><link>/archives/qemu-img_resize/</link><description>&lt;h1&gt;0）测试环境&lt;/h1&gt;
&lt;p&gt;黑群辉DSM 6.1.X，Basic 磁盘，btrfs 分区格式
虚拟硬盘为 img 格式，原始容量 30G&lt;/p&gt;
&lt;h1&gt;1）调整虚拟硬盘容量&lt;/h1&gt;
&lt;p&gt;务必虚拟机关机情况下再操作&lt;/p&gt;
&lt;p&gt;&lt;code&gt;qemu-img resize 30G.img -- +70G&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;使用 qemu-img 命令给虚拟硬盘增加 70G 容量&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;2）使用 fdisk 无损扩容&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;fdisk 30G.img&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;具体操作记录，注意看 #号后面的中文注解&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Welcome to fdisk &lt;span class="o"&gt;(&lt;/span&gt;util-linux &lt;span class="m"&gt;2&lt;/span&gt;.34&lt;span class="o"&gt;)&lt;/span&gt;.
Changes will remain &lt;span class="k"&gt;in&lt;/span&gt; memory only, &lt;span class="k"&gt;until&lt;/span&gt; you decide to write them.
Be careful before using the write command.


Command &lt;span class="o"&gt;(&lt;/span&gt;m &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;help&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;: p &lt;span class="c1"&gt;#查看硬盘信息&lt;/span&gt;
Disk vdisk2.img: &lt;span class="m"&gt;100&lt;/span&gt; GiB, &lt;span class="m"&gt;107374182400&lt;/span&gt; bytes, &lt;span class="m"&gt;209715200&lt;/span&gt; sectors
Units: sectors of &lt;span class="m"&gt;1&lt;/span&gt; * &lt;span class="nv"&gt;512&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;512&lt;/span&gt; bytes
Sector size &lt;span class="o"&gt;(&lt;/span&gt;logical/physical&lt;span class="o"&gt;)&lt;/span&gt;: &lt;span class="m"&gt;512&lt;/span&gt; bytes / &lt;span class="m"&gt;512&lt;/span&gt; bytes
I/O size &lt;span class="o"&gt;(&lt;/span&gt;minimum/optimal&lt;span class="o"&gt;)&lt;/span&gt;: &lt;span class="m"&gt;512&lt;/span&gt; bytes / &lt;span class="m"&gt;512&lt;/span&gt; bytes
Disklabel type: dos
Disk identifier: 0xed294359

Device      Boot   Start      End  Sectors  Size Id Type
vdisk2.img1         &lt;span class="m"&gt;2048&lt;/span&gt;  &lt;span class="m"&gt;4982527&lt;/span&gt;  &lt;span class="m"&gt;4980480&lt;/span&gt;  &lt;span class="m"&gt;2&lt;/span&gt;.4G fd Linux raid autodetect
vdisk2.img2      &lt;span class="m"&gt;4982528&lt;/span&gt;  &lt;span class="m"&gt;9176831&lt;/span&gt;  &lt;span class="m"&gt;4194304&lt;/span&gt;    2G fd Linux raid autodetect
vdisk2.img3      &lt;span class="m"&gt;9437184&lt;/span&gt; &lt;span class="m"&gt;62709759&lt;/span&gt; &lt;span class="m"&gt;53272576&lt;/span&gt; &lt;span class="m"&gt;25&lt;/span&gt;.4G fd Linux raid autodetect  &lt;span class="c1"&gt;#记录下第三分区的开始位置 9437184，后边要用到&lt;/span&gt;

Command &lt;span class="o"&gt;(&lt;/span&gt;m &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;help&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;: d &lt;span class="c1"&gt;#首先删掉分区&lt;/span&gt;
Partition number &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;-3, default &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;: 

Partition &lt;span class="m"&gt;3&lt;/span&gt; has been deleted.

Command &lt;span class="o"&gt;(&lt;/span&gt;m &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;help&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;: n &lt;span class="c1"&gt;#然后新建一个，按默认选主分区跟编号即可&lt;/span&gt;
Partition &lt;span class="nb"&gt;type&lt;/span&gt;
   p   primary &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt; primary, &lt;span class="m"&gt;0&lt;/span&gt; extended, &lt;span class="m"&gt;2&lt;/span&gt; free&lt;span class="o"&gt;)&lt;/span&gt;
   e   extended &lt;span class="o"&gt;(&lt;/span&gt;container &lt;span class="k"&gt;for&lt;/span&gt; logical partitions&lt;span class="o"&gt;)&lt;/span&gt;
Select &lt;span class="o"&gt;(&lt;/span&gt;default p&lt;span class="o"&gt;)&lt;/span&gt;: 

Using default response p.
Partition number &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;,4, default &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;: 
First sector &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9176832&lt;/span&gt;-209715199, default &lt;span class="m"&gt;9177088&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;: &lt;span class="m"&gt;9437184&lt;/span&gt; &lt;span class="c1"&gt;#这里是无损扩容的关键，必须不能填错&lt;/span&gt;
Last sector, +/-sectors or +/-size&lt;span class="o"&gt;{&lt;/span&gt;K,M,G,T,P&lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9437184&lt;/span&gt;-209715199, default &lt;span class="m"&gt;209715199&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;: 

Created a new partition &lt;span class="m"&gt;3&lt;/span&gt; of &lt;span class="nb"&gt;type&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Linux&amp;#39;&lt;/span&gt; and of size &lt;span class="m"&gt;95&lt;/span&gt;.5 GiB.
Partition &lt;span class="c1"&gt;#3 contains a linux_raid_member signature.&lt;/span&gt;

Do you want to remove the signature? &lt;span class="o"&gt;[&lt;/span&gt;Y&lt;span class="o"&gt;]&lt;/span&gt;es/&lt;span class="o"&gt;[&lt;/span&gt;N&lt;span class="o"&gt;]&lt;/span&gt;o: n &lt;span class="c1"&gt;# 必须选 N ，不要移除签名&lt;/span&gt;

Command &lt;span class="o"&gt;(&lt;/span&gt;m &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;help&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;: p &lt;span class="c1"&gt;#再次查看信息已经看到分区是扩容状态&lt;/span&gt;

Disk vdisk2.img: &lt;span class="m"&gt;100&lt;/span&gt; GiB, &lt;span class="m"&gt;107374182400&lt;/span&gt; bytes, &lt;span class="m"&gt;209715200&lt;/span&gt; sectors
Units: sectors of &lt;span class="m"&gt;1&lt;/span&gt; * &lt;span class="nv"&gt;512&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;512&lt;/span&gt; bytes
Sector size &lt;span class="o"&gt;(&lt;/span&gt;logical/physical&lt;span class="o"&gt;)&lt;/span&gt;: &lt;span class="m"&gt;512&lt;/span&gt; bytes / &lt;span class="m"&gt;512&lt;/span&gt; bytes
I/O size &lt;span class="o"&gt;(&lt;/span&gt;minimum/optimal&lt;span class="o"&gt;)&lt;/span&gt;: &lt;span class="m"&gt;512&lt;/span&gt; bytes / &lt;span class="m"&gt;512&lt;/span&gt; bytes
Disklabel type: dos
Disk identifier: 0xed294359

Device      Boot   Start       End   Sectors  Size Id Type
vdisk2.img1         &lt;span class="m"&gt;2048&lt;/span&gt;   &lt;span class="m"&gt;4982527&lt;/span&gt;   &lt;span class="m"&gt;4980480&lt;/span&gt;  &lt;span class="m"&gt;2&lt;/span&gt;.4G fd Linux raid autodetect
vdisk2.img2      &lt;span class="m"&gt;4982528&lt;/span&gt;   &lt;span class="m"&gt;9176831&lt;/span&gt;   &lt;span class="m"&gt;4194304&lt;/span&gt;    2G fd Linux raid autodetect
vdisk2.img3      &lt;span class="m"&gt;9437184&lt;/span&gt; &lt;span class="m"&gt;209715199&lt;/span&gt; &lt;span class="m"&gt;200278016&lt;/span&gt; &lt;span class="m"&gt;95&lt;/span&gt;.5G &lt;span class="m"&gt;83&lt;/span&gt; Linux

Command &lt;span class="o"&gt;(&lt;/span&gt;m &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;help&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;: w &lt;span class="c1"&gt;#最后按 w 保存分区表&lt;/span&gt;
The partition table has been altered.
Syncing disks.
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;3）打开虚拟机，使用 存储空间管理员 扩容即可&lt;/h1&gt;
&lt;p&gt;点 &lt;code&gt;管理&lt;/code&gt;，按提示操作&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img data-width="1008" data-height="678" src="https://raw.githubusercontent.com/fejich/fejich.github.io/source/src/images/%E5%AD%98%E5%82%A8%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86%E5%91%98.png" alt="存储空间管理员" /&gt;&lt;figcaption&gt;存储空间管理员&lt;/figcaption&gt;&lt;/figure&gt;&lt;/p&gt;
</description><author>hi@imalan.cn (fejich)</author><guid isPermaLink="true">/archives/qemu-img_resize/</guid><pubDate>Tue, 07 Sep 2021 15:20:00 +0806</pubDate></item><item><title>Linux系统下使用 rsync 代替 cp</title><link>/archives/rsync/</link><description>&lt;p&gt;&lt;figure&gt;&lt;img data-width="1920" data-height="800" src="https://raw.githubusercontent.com/fejich/fejich.github.io/source/src/images/rsync-1920x800.png" alt="rsync" /&gt;&lt;figcaption&gt;rsync&lt;/figcaption&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;rsync&lt;/code&gt; 是一个常用的 Linux 应用程序，用于文件同步。&lt;/p&gt;
&lt;p&gt;它可以在本地计算机与远程计算机之间，或者两个本地目录之间同步文件。它也可以当作文件复制工具，替代 &lt;code&gt;cp&lt;/code&gt; 和 &lt;code&gt;mv&lt;/code&gt; 命令。&lt;/p&gt;
&lt;h3&gt;显示单个文件进度，保留文件的权限&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rsync -ah --progress /source /destination
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;显示总体进度，保留文件的权限&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rsync -ah --info&lt;span class="o"&gt;=&lt;/span&gt;progress2 --no-i-r /source/ /destination
&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;&lt;p&gt;目标目录destination如果不存在，rsync 会自动创建。执行上面的命令后，源目录source被完整地复制到了目标目录destination下面，即形成了destination/source的目录结构。&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;如果只想同步源目录source里面的内容到目标目录destination，则需要在源目录后面加上斜杠 / 。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h3&gt;文件夹镜像&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;rsync -ah --info=progress2 --no-i-r --delete /source/ /destination&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;设置为命令别名，方便调用&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;alias cp="rsync -ah --progress"
alias rcp="rsync -ah --info=progress2 --no-i-r"&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;rsync 常用选项：&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;-a&lt;/code&gt; 递归传输并保持所有文件属性，最常用&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-h&lt;/code&gt; 以人类可读的格式输出&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-v&lt;/code&gt; 详细模式输出&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-z&lt;/code&gt; 文件在传输时进行压缩处理&lt;/p&gt;
&lt;p&gt;&lt;code&gt;--delete&lt;/code&gt; 删除只存在于目标目录、不存在于源目标的文件，即保证目标目录是源目标的镜像。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;参考：&lt;a href="http://www.ruanyifeng.com/blog/2020/08/rsync.html"&gt;http://www.ruanyifeng.com/blog/2020/08/rsync.html&lt;/a&gt;&lt;/p&gt;
</description><author>hi@imalan.cn (fejich)</author><guid isPermaLink="true">/archives/rsync/</guid><pubDate>Tue, 07 Sep 2021 16:50:00 +0806</pubDate></item><item><title>SSH免密登录OpenWRT路由器并执行命令</title><link>/archives/ssh_autologin/</link><description>&lt;p&gt;&lt;figure&gt;&lt;img data-width="1638" data-height="954" src="https://cdn.jsdelivr.net/gh/fejich/fejich.github.io@gh-pages/archives/assets/d47543604f898de987b2d094b08a6a9b.png" alt="Dropbear" /&gt;&lt;figcaption&gt;Dropbear&lt;/figcaption&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h1&gt;前言&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;Dropbear&lt;/code&gt;是一款基于ssh协议的轻量sshd服务器，与OpenSSH相比，他更简洁，更小巧，运行起来占用的内存也更少。&lt;/p&gt;
&lt;p&gt;每一个普通用户登录，OpenSSH会开两个sshd进程，而dropbear只开一个进程，所以其对硬件要求更低，也更利于系统的运行。&lt;/p&gt;
&lt;p&gt;Dropbear常用于“嵌入”式的Linux（或其他Unix）系统，OpenWRT 路由系统就是其中之一&lt;/p&gt;
&lt;h1&gt;配置 ssh 密钥&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;ssh-keygen -t rsa&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;连续三次回车,即在本地主机上生成了公钥和私钥,不设置密码&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;cat ~/.ssh/id_rsa.pub | ssh -p 1022 root@192.168.168.1 'cat &amp;gt;&amp;gt; /etc/dropbear/authorized_keys'&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;将本地密钥写入到路由信任列表内&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;测试免密登录路由器并执行命令&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;ssh -p 1022 root@192.168.168.1 "touch /root/test ; ls"&lt;/code&gt;&lt;/p&gt;
&lt;h1&gt;配置 crontab 定时执行命令&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;crontab -e&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#凌晨4点重启路由+5点进行时间同步&lt;/span&gt;
&lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;4&lt;/span&gt; * * * ssh -p &lt;span class="m"&gt;1022&lt;/span&gt; root@192.168.168.1 &lt;span class="s2"&gt;&amp;quot;reboot&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;5&lt;/span&gt; * * * ssh -p &lt;span class="m"&gt;1022&lt;/span&gt; root@192.168.168.1 &lt;span class="s2"&gt;&amp;quot;ntpd -n -q -p ntp.aliyun.com&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;参考&lt;/h1&gt;
&lt;p&gt;&lt;a href="https://www.jqhtml.com/61355.html"&gt;https://www.jqhtml.com/61355.html&lt;/a&gt;&lt;/p&gt;
</description><author>hi@imalan.cn (fejich)</author><guid isPermaLink="true">/archives/ssh_autologin/</guid><pubDate>Tue, 07 Sep 2021 19:30:00 +0806</pubDate></item></channel></rss>